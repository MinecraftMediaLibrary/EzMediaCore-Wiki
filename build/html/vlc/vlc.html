

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>MinecraftMediaLibrary General Information &mdash; MinecraftMediaLibrary Latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Support for Windows (Easy)" href="binaries/windows-installation.html" />
    <link rel="prev" title="Entity Nametags in a Nutshell" href="../entity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MinecraftMediaLibrary
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../history.html">History of MinecraftMediaLibrary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../map.html">Minecraft Maps in a Nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../entity.html">Entity Nametags in a Nutshell</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MinecraftMediaLibrary General Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vlc-media-player">VLC Media Player</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementing-vlc-into-minecraftmedialibrary">Implementing VLC Into MinecraftMediaLibrary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-vlc-binaries">Handling VLC Binaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="binaries/windows-installation.html">Support for Windows (Easy)</a></li>
<li class="toctree-l3"><a class="reference internal" href="binaries/mac-installation.html">Support for Mac (Medium)</a></li>
<li class="toctree-l3"><a class="reference internal" href="binaries/linux-installation.html">Support for Linux (Extremely Hard)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loading-vlc-binaries">Loading VLC Binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mmlnativediscovery">MMLNativeDiscovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="load/windows-load.html">Loading VLC Binaries on Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="load/mac-load.html">Loading VLC Binaries on Mac</a></li>
<li class="toctree-l3"><a class="reference internal" href="load/linux-load.html">Loading VLC Binaries on Linux</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code/youtube/youtube-extraction.html">Retrieving Video/Audio from Youtube Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code/video/video-player.html">Introduction to Video Players</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code/http/http-daemon.html">Using HTTP Daemons for Resourcepacks</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MinecraftMediaLibrary</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MinecraftMediaLibrary General Information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/vlc/vlc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="minecraftmedialibrary-general-information">
<h1>MinecraftMediaLibrary General Information<a class="headerlink" href="#minecraftmedialibrary-general-information" title="Permalink to this headline">¶</a></h1>
<p>This section is intended for developers and <strong>strongly</strong> recommended for readers to take
a look at if they want to use the library and know what is going on internally.</p>
<div class="section" id="vlc-media-player">
<h2>VLC Media Player<a class="headerlink" href="#vlc-media-player" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/vlc.svg"><img alt="../_images/vlc.svg" src="../_images/vlc.svg" width="256" /></a>
<p>The library uses a very common media player today known as
<a class="reference external" href="https://www.videolan.org/">VLC Media Player</a>. The reason due to this is because
of how efficient the program is to provide callbacks to actual frames in production
code. It is able to read an MPEG file and many other video formats allowing it to be
flexible, and a very much valid option to choose.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Frame callbacks (as described above) are callbacks where an external library or API
sends frame data to your own consumer, allowing you to process the data if necessary.
In this case, VLC Media Player is used to send frame data from the MPEG video into
our application, which allows easier processing and faster video data retrieval (due
to how it is written in C/C++/Lua).</p>
</div>
</div>
<div class="section" id="implementing-vlc-into-minecraftmedialibrary">
<h2>Implementing VLC Into MinecraftMediaLibrary<a class="headerlink" href="#implementing-vlc-into-minecraftmedialibrary" title="Permalink to this headline">¶</a></h2>
<p>Obviously, VLC Media Player is not written in Java, but mainly composed in C, C++, and
other native libraries. Luckily, a project known as <a class="reference external" href="https://github.com/caprica/vlcj">VLCJ</a>
which provides bindings and a functional API to provide callbacks into Java code.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While VLCJ is able to provide us with built in video players, there are some drawbacks.
For example, VLCJ is not suitable for multiple players at once! Take a look at
<a class="reference external" href="https://capricasoftware.co.uk/projects/vlcj-pro">this post</a> about how the creator
of VLCJ (Caprica) attempts to solve this issue by creating “Out of Process” media players.
To sum up, some of the libraries VLC uses are not thread-safe and reentrant, causing them
to create fatal crashes. This means multiple concurrent threads (or video players) accessing
such native libraries will likely be unsafe.</p>
</div>
<p>Due to such restrictions, MinecraftMediaLibrary as in the current patch does not support multiple
video playback at once. It is unsafe and not ready for production. However, in the near future,
perhaps VLCJ - Pro could be an option.</p>
</div>
<div class="section" id="handling-vlc-binaries">
<h2>Handling VLC Binaries<a class="headerlink" href="#handling-vlc-binaries" title="Permalink to this headline">¶</a></h2>
<p>This is arguably one of the hardest problems I had to solve – giving support to multiple platforms.
Not everyone will have VLC installed on their PC. I had to find a way to fix or bypass this issue.
Unfortunately, VLC uses binaries that are dependent on the Operating System of the environment. This
means that Windows, Mac, Linux (and even separate Linux Distributions) have their own binaries to use.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For information about how I implemented a solution to install the binaries for the users, take a look
below.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="binaries/windows-installation.html">Support for Windows (Easy)</a></li>
<li class="toctree-l1"><a class="reference internal" href="binaries/mac-installation.html">Support for Mac (Medium)</a></li>
<li class="toctree-l1"><a class="reference internal" href="binaries/linux-installation.html">Support for Linux (Extremely Hard)</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="loading-vlc-binaries">
<h2>Loading VLC Binaries<a class="headerlink" href="#loading-vlc-binaries" title="Permalink to this headline">¶</a></h2>
<p>Loading VLC binaries is a separate issue as each operating system requires it’s own method of loading the
VLC binaries. After installing the binaries for the user, we must load them properly in order for the
library to use them properly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VLCJ provides a great strategy for loading called
<a class="reference external" href="http://caprica.github.io/vlcj/javadoc/4.0.4/uk/co/caprica/vlcj/factory/discovery/NativeDiscovery.html">NativeDiscovery</a>
however, due to how Minecraft servers function, this method will not work.</p>
</div>
<p>To go into more detail on why NativeDiscovery does not work, the method uses
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">ServiceLoader</a> to find and load
the possible directories. The class which uses ServiceLoader can be found
<a class="reference external" href="http://caprica.github.io/vlcj/javadoc/4.0.7/uk/co/caprica/vlcj/factory/discovery/provider/DirectoryProviderDiscoveryStrategy.html">here</a>.
According to StackOverflow, ServiceLoader will only find certain classes loaded by the current classloader thread. After
a load of debugging, I’ve finally found that due to how the Minecraft server is running on a different classloader thread
from the actual library, it can find the proper paths. Thus, I had to implement my own mini-NativeDiscovery implementation
to try and load VLC. This discovery method is known as <strong>MinecraftMediaLibrary NativeDiscovery</strong>, or <strong>MMLNativeDiscovery</strong>
in short.</p>
</div>
<div class="section" id="mmlnativediscovery">
<h2>MMLNativeDiscovery<a class="headerlink" href="#mmlnativediscovery" title="Permalink to this headline">¶</a></h2>
<p>I created separate abstractions for each module. In order to load VLC binaries, I created a method which takes in
a directory and attempts to load VLC from that directory. It uses recursion to locate the plugins folder and the folder
containing core libraries of VLC (such as libvlc, libvlccore, etc). The strategy/algorithm can be found
<a class="reference external" href="https://github.com/MinecraftMediaLibrary/MinecraftMediaLibrary/blob/2c80ff5441e2108fba6e365dd0709ac95a122713/minecraftmedialibrary-api/src/main/java/com/github/pulsebeat02/minecraftmedialibrary/vlc/os/MMLNativeDiscovery.java#L69">here</a>.</p>
<p>It first tries to identify if NativeDiscovery works on the system or not (which we know doesn’t work, but maybe it will work
some day!). Then, I used a heuristic algorithm to improve the search. I added keywords that sort the PriorityQueue such that
files with the keyword would appear at the top, improving overall speed.</p>
<p>Once I found the plugins folder, I set the VLC plugin path relative to that. It sets an enviornment variable that VLC can use.
If I found the native library, I also set that up too. Each operating system has it’s own relative paths to set for environment
variables and VLC path.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information about how I loaded each of the binaries for the Operating Systems, take a look at the links below.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="load/windows-load.html">Loading VLC Binaries on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="load/mac-load.html">Loading VLC Binaries on Mac</a></li>
<li class="toctree-l1"><a class="reference internal" href="load/linux-load.html">Loading VLC Binaries on Linux</a></li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="binaries/windows-installation.html" class="btn btn-neutral float-right" title="Support for Windows (Easy)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../entity.html" class="btn btn-neutral float-left" title="Entity Nametags in a Nutshell" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, PulseBeat_02.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>